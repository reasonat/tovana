<?php
 

function bruria_commerce_price_formatted_components_alter(&$components, $price, $entity) {
  foreach ($components as &$component) {
    $component['title'] = t($component['title']);
  }
}

/*********  change add to cart button text ************/

function bruria_form_alter(&$form, &$form_state, $form_id) { 
  if (strpos($form_id, 'commerce_cart_add_to_cart_form') !== FALSE) {
    if ($form['submit']['#value'] == t('Add to cart')){
      $form['submit']['#value'] = t('Register');
    }
    else{
      $form['submit']['#value'] = t('Registration closed');
    }
  }
}

/**********  add a permission to see only user tab  *************/

function bruria_form_comment_form_alter(&$form) {
  $form['author']['homepage']['#access'] = FALSE;
}

 function bruria_views_access_callbacks() {
  return array(
    'bruria_user_has_access' => t('User can only see tab on his own profile'));
}

function bruria_user_has_access() {
  global $user;
  if (arg(0) == 'user' && $user->uid == arg(1)){
    return TRUE;
  }
  else {
    return FALSE;
  }
}

/**
 * Implements hook_block_info().
 *
 * This hook declares what blocks are provided by the module.
 */
function bruria_block_info() {
  $blocks['magento_mailing_iframe'] = array(
    'info' => t('Mailing list widget'),
  );
  return $blocks;
}

/**
 * Implements hook_block_view().
 *
 * This hook generates the contents of the blocks themselves.
 */
function bruria_block_view($delta = '') {
  switch ($delta) {
    case 'magento_mailing_iframe':
      // The subject is displayed at the top of the block. Note that it
      // should be passed through t() for translation. The title configured
      // for the block using Drupal UI supercedes this one.
      $block['subject'] = t('Join our newsletter');
      // The content of the block is typically generated by calling a custom
      // function.
      $block['content'] = '<div class="before">' . t('Please enter your details below to join our mailing list.') . '</div>' . '<iframe src="http://thusheard.com/joomla/index.php?option=com_acymailing&ctrl=sub&task=display&tmpl=component&formid=119" height="220" frameborder="0" width="100%" ></iframe>';
      break;
  }
  return $block;
}

//no empty line @ end of file